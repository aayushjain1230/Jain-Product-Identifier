<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>But Is It Jain?</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>

<body>

  <div id="infoModal" class="modal">
    <div class="modal-content">
      <span id="closeModal" class="close">&times;</span>
      <h2>How to Use This App</h2>
      <p>1. Find a product with an ingredient label.</p>
      <p>2. Tap <b>Scan a Label</b> and take a clear photo of the full ingredient list.</p>
      <p>3. Wait a moment while the app analyzes it.</p>
      <p>4. View the breakdown showing which ingredients are Jain-friendly or not.</p>
      <button id="modalOk" class="modal-btn">Got it</button>
    </div>
  </div>

  <div class="container">
    <h1>But Is It Jain?</h1>

    <div class="translate-wrapper">
      <div class="translate-header">
        <img src="https://www.gstatic.com/images/branding/product/1x/translate_24dp.png" alt="G" width="20">
        <span>Google Translate</span>
      </div>
      <div id="google_translate_element"></div>
    </div>
    
    <div id="preview-container">
      <img id="preview" alt="" style="display:none;">

      <div id="crop-container" style="display:none; text-align:center; width: 100%;">
        <canvas id="cropCanvas"></canvas>
        <div class="crop-controls">
          <button id="confirmCropBtn" class="action-btn primary-btn" type="button">Apply Crop</button>
          <button id="cancelCropBtn" class="action-btn" type="button">Cancel</button>
        </div>
      </div>

      <dotlottie-wc 
        id="scanAnimation"
        src="https://lottie.host/4895fcc9-7c2d-4d10-b66f-e3527a24bc18/sF20dKgvu1.lottie" 
        style="width: 300px; height: 300px" 
        autoplay 
        loop>
      </dotlottie-wc>

      <div id="crop-buttons" style="display:none;">
        <button id="crop-btn" class="action-btn" type="button">âœ‚ Crop</button>
        <button id="revert-btn" class="action-btn" type="button" style="display:none;">â†© Revert</button>
        <button id="retake-btn" class="action-btn" type="button">ðŸ”„ Retake</button>
        <button id="confirm-btn" class="action-btn primary-btn" type="button">âœ” Confirm</button>
      </div>
      
      <div id="tip-box">
        <span class="tip-label">Tip:</span>
        <span id="tip-text">Hold your phone steady for a clear scan.</span>
      </div>
    </div>

    <div id="result_desc"></div>
    
    <div id="spinner" class="spinner" style="display:none;"></div>
  </div>

  <div class="bottom-bar">
    <label for="uploaded_image" class="upload-btn">Scan a Label</label>
    <div id="info-btn" class="info-icon">i</div>
    <input type="file" id="uploaded_image" accept="image/*" capture="environment">
  </div>

  <script src="{{ url_for('static', filename='script.js') }}"></script>
  <script src="https://unpkg.com/@lottiefiles/dotlottie-wc@0.8.5/dist/dotlottie-wc.js" type="module"></script>

  <script type="text/javascript">
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({
        pageLanguage: 'en',
        includedLanguages: 'hi,bn,gu,mr,ta,te,kn,es,fr,ar,zh-CN',
        layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
        autoDisplay: false
      }, 'google_translate_element');
    }
  </script>
  <script type="text/javascript" src="https://translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>

</body>
</html>
